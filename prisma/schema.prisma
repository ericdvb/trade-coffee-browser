// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider    = "postgresql"
  url         = env("DATABASE_URL")
  extensions  = [pgcrypto]
}

model Coffee {
  id                    String    @id @default(uuid())
  fetchedAtTime         String?
  roaster               Roaster   @relation(fields: [roasterId], references: [id])
  roasterId             String
  detailPageURI         String
  coffeeName            String
  coffeeImageURI        String
  coffeeWeight          String
  flavors               String[]
  tradeDescription      String
  shortDescription      String?
  roasterDescription    String?
  process               String?
  subRegion             String?
  elevationHi           Int?
  elevationLow          Int?
  starRating            Int?
  bodyLevel             Int?
  acidityLevel          Int?
  roastLevel            Int?
  queueable             Boolean
  varietal              String[]
  tasteGroup            String?
  selectEligible        Boolean
  premiumEligible       Boolean
  classicsEligible      Boolean
  price                 Json

  @@unique(fields: [coffeeName, roasterId], name: "coffeeNameRoasterKey")
}

model Roaster {
  id              String @id @default(uuid())
  name            String @unique
  imageURI        String?
  location        String?
  coffees         Coffee[]
  roasterURI      String
}

model User {
  id                        String @id @default(uuid())
  username                  String @unique
  role                      String @db.VarChar(200) @default("customer") //TODO: change to an enum
  hashed_password           String @db.VarChar(200)
  email_confirmed_at        DateTime? @db.Timestamptz(3)
  confirmation_token        String? @db.VarChar(200)
  confirmation_sent_at      DateTime? @db.Timestamptz(3)
  recovery_sent_at          String? @db.VarChar(200)
  last_sign_in_at           DateTime? @db.Timestamptz(3)
  created_at                DateTime? @db.Timestamptz(3)
  updated_at                DateTime? @db.Timestamptz(3)
  phone                     DateTime? @db.Timestamptz(3)
  phone_confirmed_at        DateTime? @db.Timestamptz(3)
}
